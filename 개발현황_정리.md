# Golf Stats App - 개발 현황 정리

**작성일**: 2025-01-XX  
**프로젝트명**: Golf Stats App  
**프레임워크**: Flutter 3.x (Dart 3.9.0)  
**배포 URL**: https://noah8010.github.io/golf_snap_userdata/  
**현재 브랜치**: main (소스 코드)

---

## 📋 프로젝트 개요

골프 라운드 데이터를 분석하여 스코어, 퍼팅, 드라이버 통계를 제공하는 Flutter 웹 애플리케이션입니다. JSON 형식의 샘플 데이터를 로드하여 다양한 통계 분석 기능을 제공합니다.

---

## 🛠️ 기술 스택

### 핵심 기술
- **Flutter**: 3.x (크로스 플랫폼 프레임워크)
- **Dart**: 3.9.0
- **상태 관리**: Riverpod 2.5.1
- **차트 라이브러리**: fl_chart 0.68.0
- **폰트**: Google Fonts (Outfit) 6.2.1
- **국제화**: intl 0.19.0
- **JSON 직렬화**: json_annotation 4.9.0, json_serializable 6.8.0

### 아키텍처 패턴
- **Repository Pattern**: 데이터 접근 계층 분리
- **Provider Pattern**: 상태 관리 및 의존성 주입 (Riverpod)
- **MVVM**: Model-View-ViewModel 구조

---

## 📁 프로젝트 구조

```
lib/
├── models/              # 데이터 모델 (11개)
│   ├── round.dart       # 라운드 데이터 모델
│   ├── hole.dart        # 홀 데이터 모델
│   ├── shot.dart        # 샷 데이터 모델
│   ├── driver_analysis.dart  # 드라이버 분석 모델
│   ├── putt_analysis.dart    # 퍼팅 분석 모델
│   ├── putting_stats.dart    # 퍼팅 통계 모델
│   ├── benchmark_stats.dart  # 벤치마크 통계 모델
│   ├── score_trend.dart      # 스코어 추세 모델
│   ├── score_record.dart     # 스코어 기록 모델
│   ├── score_breakdown.dart  # 스코어 분류 모델
│   └── code_master.dart      # 코드 마스터 모델
│
├── repositories/        # 데이터 처리 로직 (5개)
│   ├── asset_repository.dart    # JSON 데이터 로딩
│   ├── stats_repository.dart    # 기본 통계 계산
│   ├── driver_repository.dart   # 드라이버 통계 계산
│   ├── putting_repository.dart  # 퍼팅 통계 계산
│   └── benchmark_repository.dart # 벤치마크 통계 계산
│
├── viewmodels/          # 상태 관리 (2개)
│   ├── providers.dart         # 메인 Providers (통계, 드라이버, 벤치마크)
│   └── putting_providers.dart # 퍼팅 전용 Providers
│
├── views/               # UI 화면 (4개 화면 + 위젯)
│   ├── dashboard_screen.dart         # 대시보드 (메인 화면)
│   ├── score_stats_screen.dart       # 스코어 분석 화면
│   ├── putting_analysis_screen.dart  # 퍼팅 분석 화면
│   ├── driver_analysis_screen.dart   # 드라이버 분석 화면
│   └── widgets/                      # 재사용 가능한 UI 컴포넌트 (12개)
│       ├── stat_card.dart
│       ├── score_record_card.dart
│       ├── comparison_card.dart
│       ├── distance_stats_card.dart
│       ├── accuracy_stats_card.dart
│       ├── penalty_stats_card.dart
│       ├── ball_flight_chart.dart
│       ├── distance_success_chart.dart
│       ├── three_putt_pie_chart.dart
│       ├── first_putt_card.dart
│       ├── scorecard_table.dart
│       └── scorecard_expansion_tile.dart
│
├── utils/               # 유틸리티 (2개)
│   ├── app_constants.dart  # 앱 상수 (색상, 스타일)
│   └── format_utils.dart   # 포맷팅 유틸리티
│
└── main.dart            # 앱 진입점

assets/data/             # 샘플 데이터
├── all_sample_rounds.json    # 라운드 데이터
└── code_master_data.json     # 코드 마스터 데이터
```

---

## 🎯 구현된 주요 기능

### 1. 대시보드 (DashboardScreen)
- **개요 통계**: 평균 스코어, 평균 퍼팅, 드라이버 비거리, GIR, 페어웨이 적중률
- **베스트/워스트 스코어**: 최고/최저 스코어 및 골프장 정보 표시
- **라운드 필터링**: 10/20/30 라운드 또는 전체 선택 가능
- **네비게이션**: 스코어 분석, 퍼팅 분석, 드라이버 분석 화면으로 이동

### 2. 스코어 분석 (ScoreStatsScreen)
- **기본 통계**: 평균 스코어, 핸디캡, 언더/오버파 평균
- **스코어 추세**: 라운드별 스코어 추이 그래프
- **스코어 분포**: 스코어별 발생 빈도 그래프
- **Par별 평균**: Par 3/4/5별 평균 스코어
- **홀별 평균**: 1-18홀별 평균 스코어
- **스코어 분류**: 버디, 파, 보기, 더블보기 이상 분포
- **스코어카드**: 라운드별 상세 스코어카드 표시

### 3. 퍼팅 분석 (PuttingAnalysisScreen)
- **거리별 성공률**: 0-5m, 5-10m, 10-15m, 15-20m, 20-25m, 25-30m, 30m+ 구간별 성공률
- **첫 퍼팅 성공률**: 첫 퍼팅으로 홀인 성공률
- **3퍼트 발생률**: 3퍼트 이상 발생 비율
- **퍼팅 통계 차트**: 거리별 성공률 막대 그래프, 3퍼트율 파이 차트

### 4. 드라이버 분석 (DriverAnalysisScreen)
- **비거리 분석**:
  - 평균 총 비거리 (Total Distance)
  - 평균 캐리 비거리 (Carry Distance)
  - 평균 런 (Run)
  - 최장 비거리
  - 비거리 표준편차 (일관성)
- **정확도 분석**:
  - 페어웨이 적중률
  - 좌우 편차 (Left/Right Deviation)
- **페널티 분석**:
  - OB 발생률
  - 해저드 발생률
- **구질 분석**:
  - 드로우/페이드/스트레이트 분포
  - 구질별 평균 비거리
- **스윙 효율성**:
  - 평균 볼 스피드
  - 평균 클럽 스피드
  - 스매시 팩터
- **발사 조건**:
  - 평균 발사각
  - 평균 스핀량
  - 평균 어택 앵글
- **벤치마크 비교**: 전체 사용자 대비 백분위수 표시

### 5. 벤치마크 통계 (BenchmarkRepository)
- **전체 통계**: 모든 라운드의 평균 통계
- **상위 10%**: 최고 성적 라운드들의 통계
- **하위 10%**: 최저 성적 라운드들의 통계
- **분포 데이터**: 백분위수 계산을 위한 분포 데이터
- **사용자 백분위수**: 사용자 통계가 전체 데이터에서 어느 위치인지 계산

---

## 📊 데이터 모델 구조

### Round (라운드)
- 라운드 기본 정보: `roundId`, `userId`, `playedAt`, `ccId`, `ccName`, `courseId`, `courseName`
- 게임 정보: `gameMode`, `gameRule`, `teeBox`, `totalPar`
- 스코어 정보: `totalScore`, `totalPutts`, `fairwaysHit`, `fairwaysAttempted`, `greensInRegulation`
- 상세 데이터: `holes` (List<Hole>), `shots` (List<Shot>)

### Hole (홀)
- 홀 정보: `holeNumber`, `par`, `strokes`, `putts`
- 통계: `fairwayHit`, `gir`, `penalties`

### Shot (샷)
- 샷 기본 정보: `clubType`, `shotType`, `lie`, `isMulligan`
- 퍼팅 정보: `isPutt`, `puttLength`, `puttMade`
- 센서 데이터: `totalDistance`, `carryDistance`, `ballSpeed`, `clubSpeed`, `launchAngle`, `spinRate`, `attackAngle` 등

### DriverAnalysis (드라이버 분석)
- 비거리: `averageTotalDistance`, `averageCarryDistance`, `maxDistance`, `distanceStdDev`
- 정확도: `fairwayHitRate`, `leftDeviation`, `rightDeviation`
- 페널티: `obRate`, `hazardRate`
- 구질: `drawRate`, `fadeRate`, `straightRate`, `ballFlightDistribution`
- 효율성: `averageBallSpeed`, `averageClubSpeed`, `smashFactor`
- 발사 조건: `averageLaunchAngle`, `averageSpinRate`, `averageAttackAngle`
- 분산 데이터: `dispersionPoints` (x, y 좌표)

### PuttAnalysis (퍼팅 분석)
- 거리별 성공률: `distanceSuccessRate` (Map<String, double>)
- 첫 퍼팅 성공률: `firstPuttSuccessRate`
- 3퍼트 발생률: `threePuttRate`

### BenchmarkStats (벤치마크 통계)
- 전체/상위10%/하위10% 통계: `overall`, `top10`, `bottom10`
- 분포 데이터: `scoreDistribution`, `fairwayDistribution`, `driverDistanceDistribution`, `puttsDistribution`, `girDistribution`

---

## 🔑 주요 구현 특징

### 1. Repository Pattern
- 각 통계 영역별로 Repository 클래스 분리
- `StatsRepository`: 기본 통계 계산
- `DriverRepository`: 드라이버 전용 통계
- `PuttingRepository`: 퍼팅 전용 통계
- `BenchmarkRepository`: 벤치마크 통계

### 2. Riverpod 상태 관리
- `FutureProvider`: 비동기 데이터 로딩 (라운드, 코드마스터)
- `Provider`: Repository 인스턴스 제공
- `StateProvider`: 사용자 ID, 라운드 제한 수 등 상태 관리
- `Provider`: 계산된 통계 데이터 제공

### 3. 데이터 필터링
- `filteredRoundsProvider`: 사용자 ID + 라운드 제한 수로 필터링
- 날짜순 정렬 (최신순)
- 모든 통계 Provider가 `filteredRoundsProvider`를 기반으로 계산

### 4. JSON 직렬화
- `json_annotation`과 `json_serializable` 사용
- 모든 모델 클래스에 `@JsonSerializable()` 적용
- `.g.dart` 파일 자동 생성

### 5. UI 컴포넌트화
- 재사용 가능한 위젯으로 분리
- 통계 카드, 차트, 비교 카드 등 모듈화
- 일관된 디자인 시스템 적용

---

## 📝 주요 Provider 목록

### 데이터 로딩
- `allRoundsProvider`: 모든 라운드 데이터
- `codeMastersProvider`: 코드 마스터 데이터
- `filteredRoundsProvider`: 필터링된 라운드 (사용자 + 제한)

### 기본 통계
- `userStatsProvider`: 평균 스코어, 퍼팅, 드라이버 비거리, GIR, 페어웨이
- `scoreRecordsProvider`: 베스트/워스트 스코어
- `handicapProvider`: 핸디캡
- `overUnderParProvider`: 언더/오버파 평균
- `scoreDistributionProvider`: 스코어 분포
- `scoreTrendProvider`: 스코어 추세
- `scoreByParProvider`: Par별 평균 스코어
- `scoreByHoleProvider`: 홀별 평균 스코어
- `scoreBreakdownProvider`: 스코어 분류
- `doubleBogeyRateProvider`: 더블보기 이상 발생률
- `underParRateProvider`: 언더파 달성률

### 퍼팅 통계
- `puttAnalysisProvider`: 퍼팅 분석 데이터

### 드라이버 통계
- `driverAnalysisProvider`: 드라이버 분석 데이터

### 벤치마크 통계
- `benchmarkStatsProvider`: 벤치마크 통계
- `userPercentilesProvider`: 사용자 백분위수

---

## 🎨 UI/UX 특징

### 디자인
- Material Design 3 적용
- Google Fonts (Outfit) 사용
- 다크 테마 기반 색상 체계
- 카드 기반 레이아웃

### 차트
- `fl_chart` 라이브러리 사용
- 막대 그래프, 선 그래프, 파이 차트 등 다양한 차트 타입
- 인터랙티브 차트 (호버, 툴팁)

### 반응형
- 웹 브라우저 최적화
- 모바일 웹 지원

---

## 📚 문서화 상태

### 완료된 문서
- ✅ `README.md`: 프로젝트 개요, 실행 방법, 배포 가이드
- ✅ `docs/인수인계_문서.md`: 한글 핸드오버 문서
- ✅ `docs/dev/`: 개발 관련 문서들

### 문서 내용
- 프로젝트 구조 설명
- 기술 스택 설명
- 로컬 실행 방법
- GitHub Pages 배포 방법
- 데이터 구조 설명
- 주요 기능 설명

---

## 🐛 알려진 이슈

1. **Chrome 디버그 모드 에러**
   - "Cannot send Null" 에러 발생 가능
   - 해결: Release 모드 사용 권장

2. **데이터 로딩**
   - 현재 JSON 파일을 assets에서 로드
   - 실제 API 연동 시 수정 필요

3. **사용자 ID**
   - 현재 하드코딩된 'noah.nam' 사용
   - 다중 사용자 지원 시 수정 필요

---

## ✅ 코드 품질 평가

### 장점
- ✅ 명확한 아키텍처 (Repository Pattern, MVVM)
- ✅ 상태 관리 일관성 (Riverpod)
- ✅ 모듈화된 UI 컴포넌트
- ✅ 타입 안정성 (Dart의 강타입 시스템)
- ✅ JSON 직렬화 자동화
- ✅ 재사용 가능한 코드 구조

### 개선 가능 영역
- ⚠️ 에러 처리 강화 (try-catch 블록 추가)
- ⚠️ 로딩 상태 UI 개선
- ⚠️ 테스트 코드 작성 (Unit Test, Widget Test)
- ⚠️ API 연동 준비 (현재는 로컬 JSON)

---

## 📈 개발 진행도

### 완료된 기능 (약 90%)
- ✅ 데이터 모델 설계 및 구현
- ✅ Repository 패턴 구현
- ✅ Riverpod 상태 관리 설정
- ✅ 대시보드 화면
- ✅ 스코어 분석 화면
- ✅ 퍼팅 분석 화면
- ✅ 드라이버 분석 화면
- ✅ 벤치마크 통계 계산
- ✅ UI 컴포넌트 구현
- ✅ GitHub Pages 배포 설정

### 미완료/개선 필요
- ⚠️ API 연동 (현재는 로컬 JSON)
- ⚠️ 다중 사용자 지원
- ⚠️ 테스트 코드 작성
- ⚠️ 에러 처리 강화
- ⚠️ 성능 최적화 (대용량 데이터 처리)

---

## 🚀 배포 상태

### GitHub Pages
- **배포 URL**: https://noah8010.github.io/golf_snap_userdata/
- **소스 브랜치**: `main` (소스 코드)
- **배포 브랜치**: `gh-pages` (빌드된 웹 파일)
- **빌드 명령**: `flutter build web --release --base-href /golf_snap_userdata/`

### 배포 프로세스
1. `main` 브랜치에서 코드 수정 및 커밋
2. 웹 빌드 실행
3. `gh-pages` 브랜치로 전환
4. 빌드된 파일 복사
5. 커밋 및 푸시

---

## 📊 통계 기능 상세

### StatsRepository 메서드
- `calculateAverageScore`: 평균 스코어
- `calculateAveragePutts`: 평균 퍼팅 수
- `calculateDriverDistance`: 드라이버 평균 비거리
- `calculateGirPercentage`: GIR 성공률
- `calculateFairwayPercentage`: 페어웨이 적중률
- `getBestScoreRecord`: 베스트 스코어
- `getWorstScoreRecord`: 워스트 스코어
- `calculateHandicap`: 핸디캡 계산
- `calculateAverageOverUnderPar`: 언더/오버파 평균
- `getScoreDistribution`: 스코어 분포
- `getScoreTrend`: 스코어 추세
- `getAverageScoreByPar`: Par별 평균 스코어
- `getAverageScoreByHoleNumber`: 홀별 평균 스코어
- `getScoreBreakdown`: 스코어 분류
- `getDoubleBogeyOrWorseRate`: 더블보기 이상 발생률
- `getUnderParRate`: 언더파 달성률
- `getPuttAnalysis`: 퍼팅 분석

### DriverRepository 메서드
- `getDriverAnalysis`: 드라이버 분석 데이터 생성
- `_getDriverShots`: 드라이버 샷 필터링
- `_calculateAverageTotalDistance`: 평균 총 비거리
- `_calculateFairwayHitRate`: 페어웨이 적중률
- `_calculateObRate`: OB 발생률
- `_calculateBallFlightDistribution`: 구질 분포
- 기타 드라이버 관련 통계 계산 메서드들

### PuttingRepository 메서드
- `getPuttingStats`: 퍼팅 통계 계산
- 거리별 성공률 계산
- 첫 퍼팅 성공률 계산
- 3퍼트 발생률 계산

### BenchmarkRepository 메서드
- `calculateBenchmark`: 벤치마크 통계 계산
- `_calculateAggregateStats`: 집계 통계 계산
- `_createDistributions`: 분포 데이터 생성
- 백분위수 계산 로직

---

## 🔄 다음 단계 제안

1. **API 연동**
   - 백엔드 API 엔드포인트 연동
   - HTTP 클라이언트 (dio) 추가
   - 에러 처리 및 재시도 로직

2. **다중 사용자 지원**
   - 사용자 선택 UI
   - 로그인 기능 (필요 시)

3. **테스트 코드**
   - Unit Test (Repository 로직)
   - Widget Test (UI 컴포넌트)
   - Integration Test

4. **성능 최적화**
   - 대용량 데이터 처리 최적화
   - 메모이제이션 적용
   - 지연 로딩 (Lazy Loading)

5. **추가 기능**
   - 데이터 내보내기 (CSV, PDF)
   - 통계 비교 (기간별, 코스별)
   - 알림 기능

---

**마지막 업데이트**: 2025-01-XX  
**작성자**: AI Assistant  
**검토 필요**: 코드 리뷰 및 테스트
