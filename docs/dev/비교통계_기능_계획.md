# 비교 통계 기능 개발 계획

## 📋 개요

### 목적
사용자가 자신의 골프 통계를 다른 사용자들과 비교하여 상대적인 실력을 파악하고, 개선이 필요한 영역을 식별할 수 있도록 지원

### 기본 원칙
- 별도 탭을 만들지 않고 기존 페이지에 자연스럽게 통합
- 비교 대상: 전체 평균, 상위 10%, 하위 10%, 유사 핸디캡 그룹
- 시각적으로 명확한 비교 (색상, 아이콘, 퍼센타일 표시)

---

## 1️⃣ 대시보드 (Overview) 페이지

### 추가할 비교 데이터

#### 1.1 핵심 지표 비교 카드
기존 통계 카드에 비교 정보 추가

```
┌─────────────────────────────┐
│ 평균 스코어                  │
│ 85.2                        │
│ ────────────────────────    │
│ 전체 평균: 92.3  ↑ 상위 23% │
│ 유사 레벨: 86.1  ↑ 상위 45% │
└─────────────────────────────┘
```

**표시할 지표:**
- 평균 스코어
- 페어웨이 적중률
- GIR (그린 적중률)
- 평균 퍼팅 수

**비교 대상:**
- 전체 사용자 평균
- 유사 핸디캡 그룹 평균 (±3 타수 범위)
- 퍼센타일 표시 (상위 X%)

#### 1.2 종합 레이더 차트
나의 실력 vs 전체 평균 시각화

```
     비거리
        /\
       /  \
  정확도    퍼팅
      \  /
    어프로치
```

**차트 항목:**
- 비거리 (드라이버 평균)
- 정확도 (페어웨이 + GIR)
- 퍼팅 (평균 퍼팅 수)
- 어프로치 (100m 이내 정확도)
- 쇼트게임 (업앤다운 성공률)

**표시 방식:**
- 파란색 선: 나의 통계 (정규화)
- 회색 선: 전체 평균
- 초록색 영역: 상위 10% 범위

---

## 2️⃣ 스코어 분석 (Score Stats) 페이지

### 추가할 비교 데이터

#### 2.1 스코어 분포 비교
나의 스코어 분포 vs 전체 사용자

```
스코어 분포 비교
┌────────────────────────────┐
│ 버디 이상:  15% │ 평균: 8%  │
│ 파:        45% │ 평균: 35% │
│ 보기:      30% │ 평균: 40% │
│ 더블 이상:  10% │ 평균: 17% │
└────────────────────────────┘
```

**비교 차트:**
- 나의 분포 (막대 그래프)
- 전체 평균 분포 (점선 오버레이)
- 상위 10% 분포 (참고선)

#### 2.2 Par별 평균 비교

```
Par 3 평균
나: 3.2타 │ 전체: 3.8타 │ 상위10%: 2.9타
━━━━━━━━━━━━━━━━━━━━━━━━━━━
[나]     [전체]      [상위10%]
```

**표시 정보:**
- Par 3, 4, 5 각각의 평균 타수
- 전체 평균 대비 차이 (±0.5타)
- 상위 10% 평균과의 격차

#### 2.3 라운드별 스코어 트렌드 비교
시간에 따른 개선도 비교

```
최근 10라운드 스코어 추이
┌────────────────────────────┐
│ 나의 개선률: -2.3타/월      │
│ 평균 개선률: -0.8타/월      │
│ ↑ 평균보다 2.9배 빠른 개선  │
└────────────────────────────┘
```

---

## 3️⃣ 퍼팅 분석 (Putting Analysis) 페이지

### 추가할 비교 데이터

#### 3.1 거리별 성공률 비교
각 거리 구간별 비교

```
퍼팅 성공률 비교
┌─────────────────────────────────┐
│ 0-1m:   95% │ 평균: 88% ↑ +7%  │
│ 1-3m:   65% │ 평균: 52% ↑ +13% │
│ 3-5m:   35% │ 평균: 28% ↑ +7%  │
│ 5-10m:  15% │ 평균: 12% ↑ +3%  │
│ 10m+:    5% │ 평균:  4% ↑ +1%  │
└─────────────────────────────────┘
```

**시각화:**
- 이중 막대 그래프 (나 vs 평균)
- 차이를 색상으로 표시 (초록: 우수, 빨강: 부족)

#### 3.2 3퍼트율 비교

```
3퍼트 발생률
┌────────────────────────────┐
│ 나:      8.5%              │
│ 전체:   12.3%  ↑ 상위 35%  │
│ 상위10%: 5.2%  ↓ 3.3% 차이 │
└────────────────────────────┘
```

#### 3.3 첫 퍼팅 정확도 비교
거리별 첫 퍼팅 후 남은 거리

```
첫 퍼팅 정확도 (3m 거리)
나:      평균 0.8m 남음
전체:    평균 1.2m 남음
상위10%: 평균 0.5m 남음
━━━━━━━━━━━━━━━━━━━━━━
✓ 평균보다 33% 더 정확
```

---

## 4️⃣ 드라이버 분석 (Driver Analysis) 페이지

### 추가할 비교 데이터

#### 4.1 비거리 비교

```
평균 비거리 비교
┌────────────────────────────────┐
│ 나:      245m                  │
│ 전체:    230m  ↑ +15m (상위28%)│
│ 상위10%: 265m  ↓ -20m          │
└────────────────────────────────┘

비거리 분포 차트
[히스토그램: 나의 위치 표시]
```

**추가 비교:**
- 캐리 거리 비교
- 런 거리 비교
- 최장 비거리 순위

#### 4.2 정확도 비교

```
페어웨이 적중률
┌────────────────────────────────┐
│ 나:      68%                   │
│ 전체:    55%  ↑ +13% (상위18%) │
│ 상위10%: 78%  ↓ -10%           │
└────────────────────────────────┘

좌우 편차
나:      평균 12m
전체:    평균 18m  ↑ 33% 더 정확
상위10%: 평균 8m
```

#### 4.3 구질 분포 비교

```
구질 분포 비교
┌─────────────────────────────┐
│         나    │   전체 평균  │
│ 드로우: 35%  │   28%        │
│ 페이드: 45%  │   42%        │
│ 스트레이트: 20% │ 30%       │
└─────────────────────────────┘
```

#### 4.4 스윙 효율성 비교

```
스매시 팩터
나:      1.48
전체:    1.42  ↑ 상위 22%
이상적:  1.50  (목표치)
━━━━━━━━━━━━━━━━━━━━━
볼 스피드: 68 m/s (평균: 64 m/s)
클럽 스피드: 46 m/s (평균: 45 m/s)
```

---

## 🎨 UI/UX 디자인 가이드

### 색상 코드
- **우수 (평균 이상)**: 초록색 (#4CAF50)
- **보통 (평균 ±5% 이내)**: 회색 (#9E9E9E)
- **부족 (평균 이하)**: 주황색 (#FF9800)
- **매우 부족**: 빨간색 (#F44336)

### 아이콘
- ↑ 평균보다 우수
- ↓ 평균보다 부족
- ━ 평균 수준
- ⭐ 상위 10% 진입

### 표시 형식
```
[나의 값] │ 평균: [평균값] [아이콘] [차이/퍼센타일]
```

### 비교 섹션 배치
각 페이지에서:
1. 기존 통계 표시
2. 구분선 또는 여백
3. **"다른 사용자와 비교"** 섹션 (접을 수 있는 형태)
4. 비교 차트 및 지표

---

## 📊 필요한 데이터

### 서버에서 제공해야 할 데이터

#### 1. 전체 통계 (Aggregate Stats)
```json
{
  "overall": {
    "averageScore": 92.3,
    "fairwayAccuracy": 55.2,
    "girPercentage": 42.1,
    "averagePutts": 32.5,
    "driverDistance": 230.0,
    "driverAccuracy": 55.0
  },
  "top10": {
    "averageScore": 78.5,
    "fairwayAccuracy": 78.0,
    // ...
  },
  "bottom10": {
    // ...
  }
}
```

#### 2. 유사 레벨 통계 (Similar Level Stats)
사용자의 평균 스코어 ±3 타수 범위 사용자들의 평균

```json
{
  "similarLevel": {
    "scoreRange": [82, 88],
    "userCount": 1250,
    "averageScore": 85.3,
    // ...
  }
}
```

#### 3. 퍼센타일 정보
```json
{
  "percentiles": {
    "score": 23,  // 상위 23%
    "fairwayAccuracy": 45,
    "driverDistance": 28,
    // ...
  }
}
```

#### 4. 분포 데이터 (Distribution)
히스토그램 생성용

```json
{
  "scoreDistribution": {
    "bins": [70, 75, 80, 85, 90, 95, 100],
    "counts": [50, 120, 280, 350, 200, 80, 20],
    "userPosition": 85.2
  }
}
```

---

## 🔧 구현 단계

### Phase 1: 데이터 모델 및 API
- [ ] 비교 통계 데이터 모델 생성
- [ ] Repository에 비교 통계 계산 로직 추가
- [ ] Provider 설정

### Phase 2: UI 컴포넌트
- [ ] 비교 카드 위젯 생성
- [ ] 비교 차트 위젯 생성 (이중 막대, 레이더 등)
- [ ] 퍼센타일 표시 위젯

### Phase 3: 페이지 통합
- [ ] 대시보드에 비교 섹션 추가
- [ ] 스코어 분석에 비교 섹션 추가
- [ ] 퍼팅 분석에 비교 섹션 추가
- [ ] 드라이버 분석에 비교 섹션 추가

### Phase 4: 테스트 및 최적화
- [ ] 샘플 데이터로 테스트
- [ ] UI/UX 개선
- [ ] 성능 최적화

---

## 💡 추가 아이디어

### 1. 개인화된 인사이트
```
💡 인사이트
당신의 드라이버 비거리는 상위 28%이지만,
정확도는 상위 18%로 더 우수합니다.
비거리보다 정확도가 강점입니다!
```

### 2. 개선 목표 제안
```
🎯 다음 목표
상위 10% 진입을 위해:
- 3퍼트율 3.3% 개선 필요
- 페어웨이 적중률 10% 향상 필요
```

### 3. 랭킹 시스템
```
🏆 전체 랭킹
전체 사용자 중 #234 / 1,250명
상위 18.7%
```

### 4. 친구 비교 (향후)
특정 친구들과의 비교 기능

---

## 📝 참고사항

### 데이터 프라이버시
- 개인 식별 정보 없이 통계만 제공
- 사용자 동의 하에 데이터 수집

### 업데이트 주기
- 전체 통계: 매일 자정 업데이트
- 실시간 퍼센타일: 라운드 저장 시 계산

### 최소 데이터 요구사항
- 전체 통계 계산: 최소 100명 이상의 데이터
- 유사 레벨 통계: 최소 20명 이상

---

**작성일**: 2025-11-28  
**버전**: 1.0
