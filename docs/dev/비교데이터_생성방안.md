# ë¹„êµ í†µê³„ ë°ì´í„° ìƒì„± ë°©ì•ˆ

## ğŸ“‹ ê°œìš”

ë¹„êµ í†µê³„ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ë¥¸ ì‚¬ìš©ìë“¤ì˜ í†µê³„ ë°ì´í„°ê°€ í•„ìš”í•©ë‹ˆë‹¤. í˜„ì¬ëŠ” ì‹¤ì œ ì‚¬ìš©ì ë°ì´í„°ê°€ ì—†ìœ¼ë¯€ë¡œ, ë‹¨ê³„ì ìœ¼ë¡œ ì ‘ê·¼í•©ë‹ˆë‹¤.

---

## ğŸ¯ ë‹¨ê³„ë³„ ì ‘ê·¼ ë°©ë²•

### Phase 1: ê°€ìƒ ë°ì´í„° ìƒì„± (ê°œë°œ ë° ë°ëª¨ìš©)

ì‹¤ì œ ì‚¬ìš©ì ë°ì´í„°ê°€ ì—†ëŠ” í˜„ì¬ ìƒí™©ì—ì„œ ì‚¬ìš©í•  ë°©ë²•

#### 1.1 í†µê³„ì  ìƒ˜í”Œ ë°ì´í„° ìƒì„±

**ë°©ë²•**: í˜„ì‹¤ì ì¸ ê³¨í”„ í†µê³„ ë¶„í¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê°€ìƒ ì‚¬ìš©ì ë°ì´í„° ìƒì„±

```python
# ì˜ˆì‹œ: ê°€ìƒ ì‚¬ìš©ì í†µê³„ ìƒì„± ìŠ¤í¬ë¦½íŠ¸
import numpy as np
import json

def generate_benchmark_stats(num_users=1000):
    """
    í†µê³„ì ìœ¼ë¡œ í˜„ì‹¤ì ì¸ ë²¤ì¹˜ë§ˆí¬ ë°ì´í„° ìƒì„±
    """
    stats = {
        "overall": {},
        "top10": {},
        "bottom10": {},
        "distribution": {}
    }
    
    # í‰ê·  ìŠ¤ì½”ì–´ ìƒì„± (ì •ê·œë¶„í¬, í‰ê·  92, í‘œì¤€í¸ì°¨ 8)
    scores = np.random.normal(92, 8, num_users)
    scores = np.clip(scores, 70, 120)  # í˜„ì‹¤ì ì¸ ë²”ìœ„ë¡œ ì œí•œ
    
    stats["overall"]["averageScore"] = float(np.mean(scores))
    stats["top10"]["averageScore"] = float(np.percentile(scores, 10))
    stats["bottom10"]["averageScore"] = float(np.percentile(scores, 90))
    
    # í˜ì–´ì›¨ì´ ì ì¤‘ë¥  (í‰ê·  55%, í‘œì¤€í¸ì°¨ 12%)
    fairway = np.random.normal(55, 12, num_users)
    fairway = np.clip(fairway, 20, 90)
    
    stats["overall"]["fairwayAccuracy"] = float(np.mean(fairway))
    stats["top10"]["fairwayAccuracy"] = float(np.percentile(fairway, 90))
    
    # ... ë‹¤ë¥¸ í†µê³„ë“¤ë„ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ ìƒì„±
    
    return stats
```

#### 1.2 í˜„ì‹¤ì ì¸ í†µê³„ ë²”ìœ„ ì •ì˜

**ê³¨í”„ í†µê³„ ì—…ê³„ í‘œì¤€ ì°¸ê³ :**

| ì§€í‘œ | í‰ê·  | ìƒìœ„ 10% | í•˜ìœ„ 10% |
|------|------|----------|----------|
| í‰ê·  ìŠ¤ì½”ì–´ | 92 | 78 | 105 |
| í˜ì–´ì›¨ì´ ì ì¤‘ë¥  | 55% | 75% | 35% |
| GIR | 42% | 65% | 25% |
| í‰ê·  í¼íŒ… | 32.5 | 28 | 36 |
| ë“œë¼ì´ë²„ ë¹„ê±°ë¦¬ | 230m | 265m | 200m |
| 3í¼íŠ¸ìœ¨ | 12% | 5% | 20% |

#### 1.3 JSON íŒŒì¼ë¡œ ì €ì¥

```json
// assets/data/benchmark_stats.json
{
  "lastUpdated": "2025-11-28",
  "sampleSize": 1000,
  "overall": {
    "averageScore": 92.3,
    "fairwayAccuracy": 55.2,
    "girPercentage": 42.1,
    "averagePutts": 32.5,
    "driverDistance": 230.0,
    "driverAccuracy": 55.0,
    "threePuttRate": 12.3,
    "puttingSuccessRates": {
      "0-1m": 88.0,
      "1-3m": 52.0,
      "3-5m": 28.0,
      "5-10m": 12.0,
      "10m+": 4.0
    }
  },
  "top10": {
    "averageScore": 78.5,
    "fairwayAccuracy": 75.0,
    // ...
  },
  "bottom10": {
    "averageScore": 105.2,
    "fairwayAccuracy": 35.0,
    // ...
  },
  "percentiles": {
    "score": [70, 75, 80, 85, 90, 95, 100, 105, 110, 115, 120],
    "fairway": [25, 30, 40, 50, 55, 60, 65, 70, 75, 80, 85]
  }
}
```

---

### Phase 2: ì‹¤ì œ ì‚¬ìš©ì ë°ì´í„° í™œìš© (í–¥í›„)

ì‹¤ì œ ì„œë¹„ìŠ¤ ìš´ì˜ ì‹œ ì ìš©í•  ë°©ë²•

#### 2.1 ì„œë²„ ì¸¡ ì§‘ê³„ ì‹œìŠ¤í…œ

**ì•„í‚¤í…ì²˜:**
```
ë¼ìš´ë“œ ì €ì¥ â†’ í†µê³„ ê³„ì‚° â†’ ì§‘ê³„ DB ì—…ë°ì´íŠ¸
                              â†“
                        ë²¤ì¹˜ë§ˆí¬ í†µê³„ ì¬ê³„ì‚°
```

**êµ¬í˜„ ë°©ë²•:**
1. ë¼ìš´ë“œ ë°ì´í„° ì €ì¥ ì‹œ ê°œë³„ í†µê³„ ê³„ì‚°
2. ì§‘ê³„ í…Œì´ë¸”ì— í†µê³„ ëˆ„ì 
3. ë§¤ì¼ ìì • ë²¤ì¹˜ë§ˆí¬ í†µê³„ ì¬ê³„ì‚°
4. APIë¥¼ í†µí•´ í´ë¼ì´ì–¸íŠ¸ì— ì œê³µ

#### 2.2 ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

```sql
-- ì§‘ê³„ í†µê³„ í…Œì´ë¸”
CREATE TABLE aggregate_stats (
    stat_date DATE PRIMARY KEY,
    total_users INT,
    avg_score DECIMAL(5,2),
    avg_fairway_accuracy DECIMAL(5,2),
    avg_gir DECIMAL(5,2),
    avg_putts DECIMAL(5,2),
    avg_driver_distance DECIMAL(6,2),
    -- ... ê¸°íƒ€ í†µê³„
    percentile_10_score DECIMAL(5,2),
    percentile_90_score DECIMAL(5,2),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ë ˆë²¨ë³„ í†µê³„ í…Œì´ë¸”
CREATE TABLE level_stats (
    score_range_min INT,
    score_range_max INT,
    user_count INT,
    avg_score DECIMAL(5,2),
    avg_fairway_accuracy DECIMAL(5,2),
    -- ... ê¸°íƒ€ í†µê³„
    PRIMARY KEY (score_range_min, score_range_max)
);
```

#### 2.3 API ì—”ë“œí¬ì¸íŠ¸

```
GET /api/stats/benchmark
Response:
{
  "overall": { ... },
  "top10": { ... },
  "bottom10": { ... }
}

GET /api/stats/similar-level?avgScore=85
Response:
{
  "scoreRange": [82, 88],
  "userCount": 1250,
  "stats": { ... }
}

GET /api/stats/percentile?userId=123
Response:
{
  "score": 23,
  "fairwayAccuracy": 45,
  "driverDistance": 28
}
```

---

## ğŸ› ï¸ êµ¬í˜„ ë°©ì•ˆ (í˜„ì¬ í”„ë¡œì íŠ¸)

### ë°©ì•ˆ 1: ì •ì  JSON íŒŒì¼ ì‚¬ìš© (ì¶”ì²œ)

**ì¥ì :**
- ë¹ ë¥¸ êµ¬í˜„
- ì„œë²„ ë¶ˆí•„ìš”
- ë°ëª¨/í”„ë¡œí† íƒ€ì…ì— ì í•©

**êµ¬í˜„ ë‹¨ê³„:**

1. **ë²¤ì¹˜ë§ˆí¬ ë°ì´í„° ìƒì„± ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±**
```python
# docs/dev/generate_benchmark_data.py
import json
import numpy as np

def generate_benchmark_stats():
    # í†µê³„ì ìœ¼ë¡œ í˜„ì‹¤ì ì¸ ë°ì´í„° ìƒì„±
    return {
        "overall": {
            "averageScore": 92.3,
            "fairwayAccuracy": 55.2,
            # ... ëª¨ë“  í•„ìš”í•œ í†µê³„
        },
        "top10": { ... },
        "bottom10": { ... },
        "distributions": {
            "score": generate_score_distribution(),
            "fairway": generate_fairway_distribution(),
            # ...
        }
    }

if __name__ == "__main__":
    stats = generate_benchmark_stats()
    with open("../../assets/data/benchmark_stats.json", "w") as f:
        json.dump(stats, f, indent=2)
```

2. **ë°ì´í„° ëª¨ë¸ ìƒì„±**
```dart
// lib/models/benchmark_stats.dart
class BenchmarkStats {
  final OverallStats overall;
  final OverallStats top10;
  final OverallStats bottom10;
  final Map<String, List<double>> distributions;
  
  BenchmarkStats({
    required this.overall,
    required this.top10,
    required this.bottom10,
    required this.distributions,
  });
  
  factory BenchmarkStats.fromJson(Map<String, dynamic> json) {
    // JSON íŒŒì‹± ë¡œì§
  }
}

class OverallStats {
  final double averageScore;
  final double fairwayAccuracy;
  final double girPercentage;
  // ...
}
```

3. **Repositoryì— ë¡œë”© ë¡œì§ ì¶”ê°€**
```dart
// lib/repositories/benchmark_repository.dart
class BenchmarkRepository {
  Future<BenchmarkStats> loadBenchmarkStats() async {
    final jsonString = await rootBundle.loadString(
      'assets/data/benchmark_stats.json'
    );
    final json = jsonDecode(jsonString);
    return BenchmarkStats.fromJson(json);
  }
  
  // í¼ì„¼íƒ€ì¼ ê³„ì‚°
  int calculatePercentile(double userValue, List<double> distribution) {
    int count = 0;
    for (var value in distribution) {
      if (userValue > value) count++;
    }
    return (count * 100 / distribution.length).round();
  }
}
```

4. **Provider ì„¤ì •**
```dart
// lib/viewmodels/providers.dart
final benchmarkStatsProvider = FutureProvider<BenchmarkStats>((ref) async {
  final repo = ref.watch(benchmarkRepositoryProvider);
  return await repo.loadBenchmarkStats();
});

final userPercentileProvider = Provider<Map<String, int>>((ref) {
  final benchmarkAsync = ref.watch(benchmarkStatsProvider);
  final userStats = ref.watch(userStatsProvider);
  
  return benchmarkAsync.when(
    data: (benchmark) => calculatePercentiles(userStats, benchmark),
    loading: () => {},
    error: (_, __) => {},
  );
});
```

---

### ë°©ì•ˆ 2: ë¡œì»¬ ê³„ì‚° (í˜„ì¬ ë°ì´í„° í™œìš©)

**ì•„ì´ë””ì–´**: í˜„ì¬ `all_sample_rounds.json`ì˜ ëª¨ë“  ë¼ìš´ë“œë¥¼ ì§‘ê³„í•˜ì—¬ ë²¤ì¹˜ë§ˆí¬ë¡œ ì‚¬ìš©

**ì¥ì :**
- ì‹¤ì œ ë¼ìš´ë“œ ë°ì´í„° ê¸°ë°˜
- ì¶”ê°€ ë°ì´í„° ìƒì„± ë¶ˆí•„ìš”

**ë‹¨ì :**
- ìƒ˜í”Œ ë°ì´í„°ê°€ í•œ ì‚¬ìš©ìì˜ ê²ƒì´ë¯€ë¡œ ë¹„êµ ì˜ë¯¸ ì—†ìŒ
- ë‹¤ì–‘ì„± ë¶€ì¡±

**êµ¬í˜„:**
```dart
class BenchmarkRepository {
  BenchmarkStats calculateFromRounds(List<Round> allRounds) {
    // ëª¨ë“  ë¼ìš´ë“œì—ì„œ í†µê³„ ê³„ì‚°
    final scores = allRounds.map((r) => r.totalScore).toList();
    final avgScore = scores.reduce((a, b) => a + b) / scores.length;
    
    // ìƒìœ„/í•˜ìœ„ 10% ê³„ì‚°
    scores.sort();
    final top10Score = scores[(scores.length * 0.1).floor()];
    final bottom10Score = scores[(scores.length * 0.9).floor()];
    
    return BenchmarkStats(
      overall: OverallStats(averageScore: avgScore, ...),
      top10: OverallStats(averageScore: top10Score, ...),
      bottom10: OverallStats(averageScore: bottom10Score, ...),
    );
  }
}
```

---

## ğŸ“ ì¶”ì²œ êµ¬í˜„ ìˆœì„œ

### 1ë‹¨ê³„: ì •ì  ë²¤ì¹˜ë§ˆí¬ ë°ì´í„° ìƒì„±
- [ ] Python ìŠ¤í¬ë¦½íŠ¸ë¡œ í˜„ì‹¤ì ì¸ í†µê³„ ë°ì´í„° ìƒì„±
- [ ] `assets/data/benchmark_stats.json` íŒŒì¼ ìƒì„±
- [ ] ì—…ê³„ í‘œì¤€ ì°¸ê³ í•˜ì—¬ ê°’ ì¡°ì •

### 2ë‹¨ê³„: ë°ì´í„° ëª¨ë¸ ë° Repository
- [ ] `BenchmarkStats` ëª¨ë¸ ìƒì„±
- [ ] `BenchmarkRepository` ìƒì„±
- [ ] í¼ì„¼íƒ€ì¼ ê³„ì‚° ë¡œì§ êµ¬í˜„

### 3ë‹¨ê³„: Provider ì„¤ì •
- [ ] `benchmarkStatsProvider` ìƒì„±
- [ ] `userPercentileProvider` ìƒì„±
- [ ] ë¹„êµ ë°ì´í„° ì œê³µ Provider ìƒì„±

### 4ë‹¨ê³„: UI í†µí•©
- [ ] ê° í˜ì´ì§€ì— ë¹„êµ ìœ„ì ¯ ì¶”ê°€
- [ ] í…ŒìŠ¤íŠ¸ ë° ì¡°ì •

---

## ğŸ² ìƒ˜í”Œ ë²¤ì¹˜ë§ˆí¬ ë°ì´í„° ì˜ˆì‹œ

```json
{
  "version": "1.0",
  "lastUpdated": "2025-11-28",
  "sampleSize": 1000,
  "overall": {
    "averageScore": 92.3,
    "fairwayAccuracy": 55.2,
    "girPercentage": 42.1,
    "averagePutts": 32.5,
    "averagePuttsPerHole": 1.81,
    "threePuttRate": 12.3,
    "driverDistance": 230.0,
    "driverCarry": 215.0,
    "driverAccuracy": 55.0,
    "scoreDistribution": {
      "birdieOrBetter": 8.0,
      "par": 35.0,
      "bogey": 40.0,
      "doubleBogeyOrWorse": 17.0
    },
    "puttingByDistance": {
      "0-1m": 88.0,
      "1-3m": 52.0,
      "3-5m": 28.0,
      "5-10m": 12.0,
      "10m+": 4.0
    }
  },
  "top10": {
    "averageScore": 78.5,
    "fairwayAccuracy": 75.0,
    "girPercentage": 65.0,
    "averagePutts": 28.0,
    "threePuttRate": 5.2,
    "driverDistance": 265.0,
    "driverAccuracy": 78.0
  },
  "bottom10": {
    "averageScore": 105.2,
    "fairwayAccuracy": 35.0,
    "girPercentage": 25.0,
    "averagePutts": 36.0,
    "threePuttRate": 20.0,
    "driverDistance": 200.0,
    "driverAccuracy": 35.0
  }
}
```

---

## ğŸ’¡ ê²°ë¡ 

**í˜„ì¬ í”„ë¡œì íŠ¸ì— ê°€ì¥ ì í•©í•œ ë°©ë²•:**

1. **ì •ì  JSON íŒŒì¼ ì‚¬ìš©** (ë°©ì•ˆ 1)
   - ë¹ ë¥´ê³  ê°„ë‹¨í•œ êµ¬í˜„
   - ì„œë²„ ì—†ì´ ì‘ë™
   - í˜„ì‹¤ì ì¸ ë²¤ì¹˜ë§ˆí¬ ì œê³µ

2. **í–¥í›„ í™•ì¥ ê³ ë ¤**
   - ì‹¤ì œ ì‚¬ìš©ì ë°ì´í„° ìˆ˜ì§‘ ì‹œ ì„œë²„ ì¸¡ ì§‘ê³„ë¡œ ì „í™˜
   - API êµ¬ì¡°ëŠ” ë™ì¼í•˜ê²Œ ìœ ì§€í•˜ì—¬ ë§ˆì´ê·¸ë ˆì´ì…˜ ìš©ì´

**ë‹¤ìŒ ë‹¨ê³„:**
Python ìŠ¤í¬ë¦½íŠ¸ë¡œ `benchmark_stats.json` íŒŒì¼ì„ ìƒì„±í•˜ê³ , ì´ë¥¼ ë¡œë”©í•˜ëŠ” Repositoryì™€ Providerë¥¼ êµ¬í˜„í•˜ë©´ ë©ë‹ˆë‹¤.

---

**ì‘ì„±ì¼**: 2025-11-28  
**ë²„ì „**: 1.0
